# Домашнее задание

Создать снепшот аналитической таблицы из операционного хранилища

Цель 
Зачастую в Data Lake не требуется хранить всех сырых данных, например в ситуации когда наиболее интересными для пользователя являются какие-либо аналитические выгрузки. В нашем домашнем задании мы напишем пример такого приложения, которое позволяет писать в Data Lake текущий аналитический срез.

1. Скопируйте на свою рабочую станцию (ПК или Google Cloud) [данный репозиторий](https://github.com/renardeinside/vogel)
2. Перейдите в папку проекта (vogel) и запустите все необходимые инстансы командой `docker-compose up --build` 
3. Сгенерируйте токен для доступа к Jupyter Notebook (выполните эту команду в проектной папке):
```
docker-compose -f docker-compose.yml exec jupyter-local jupyter notebook list
```
4. Перейдите в браузер и введите в нем полученную ссылку с токеном. 
5. В Jupyter Notebook перейдите в папку work, в ней откройте ноутбук postgres_snapshot. 
6. Запустите в нем все шаги до шага `Read and join the data`. 
7. В переменную `query` запишите select-запрос, который выводит следующие данные (доступные таблицы - customers, products, orders):

`id` &mdash; id пользователя из таблицы customers
`first_name` &mdash; first_name пользователя из таблицы customers
`last_name` &mdash; last_name пользователя из таблицы customers
`total_weight` &mdash; суммарный размер всех продуктов данного пользователя (поле weight в таблице products)
`load_dttm` &mdash; дата/время выполнения команды загрузки

Выполните данную ячейку командой `Shift + Enter`. 

Дополнительные ограничения запроса &mdash; необходимо выбрать только тех пользователей, у которых id<=1005. 
Информацию по структурам таблиц вы можете прочесть в README.md файле. 

8. Проверьте что были записаны верные данные в следующей ячейке. 
9. В комментарии к ДЗ пришлите ваш форк данного репозитория с верной sql-командой. 
